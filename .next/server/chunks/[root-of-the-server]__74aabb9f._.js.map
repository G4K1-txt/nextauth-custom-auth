{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 116, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projeto/fine/src/lib/cloudinary.ts"],"sourcesContent":["import { v2 as cloudinary } from 'cloudinary';\r\n\r\ncloudinary.config({\r\n    cloud_name: process.env.NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME,\r\n    api_key: process.env.NEXT_PUBLIC_CLOUDINARY_API_KEY,\r\n    api_secret: process.env.NEXT_PUBLIC_CLOUDINARY_API_SECRET,\r\n});\r\n\r\nexport default cloudinary;"],"names":[],"mappings":";;;AAAA;;AAEA,0IAAA,CAAA,KAAU,CAAC,MAAM,CAAC;IACd,YAAY,QAAQ,GAAG,CAAC,iCAAiC;IACzD,SAAS,QAAQ,GAAG,CAAC,8BAA8B;IACnD,YAAY,QAAQ,GAAG,CAAC,iCAAiC;AAC7D;uCAEe,0IAAA,CAAA,KAAU","debugId":null}},
    {"offset": {"line": 205, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projeto/fine/src/app/api/user/upload/route.ts"],"sourcesContent":["import type { NextApiRequest, NextApiResponse } from \"next\";\r\nimport cloudinary from \"@/lib/cloudinary\";\r\nimport formidable from \"formidable\";\r\nimport fs from \"fs\";\r\nimport type { UploadApiResponse } from \"cloudinary\";\r\n\r\nexport const config = {\r\n  api: {\r\n    bodyParser: false,\r\n  },\r\n};\r\n\r\nfunction parseForm(req: NextApiRequest) {\r\n  return new Promise<{ fields: formidable.Fields; files: formidable.Files }>((resolve, reject) => {\r\n    const form = new formidable.IncomingForm();\r\n    form.parse(req, (err, fields, files) => {\r\n      if (err) reject(err);\r\n      else resolve({ fields, files });\r\n    });\r\n  });\r\n}\r\n\r\nexport default async function POST(req: NextApiRequest, res: NextApiResponse) {\r\n  console.log(\"Upload endpoint chamado\");\r\n  if (req.method !== \"POST\") return res.status(405).json({ error: \"Method Not Allowed\" });\r\n\r\n  try {\r\n    const { files } = await parseForm(req);\r\n    console.log(\"Arquivos recebidos:\", files);\r\n\r\n    const fileField = files.file || Object.values(files)[0];\r\n    if (!fileField) {\r\n      console.log(\"Nenhum arquivo enviado\");\r\n      return res.status(400).json({ error: \"Nenhum arquivo enviado.\" });\r\n    }\r\n\r\n    const fileArray = Array.isArray(fileField) ? fileField : [fileField];\r\n    const file = fileArray[0];\r\n    if (!file || !file.filepath) {\r\n      console.log(\"Arquivo inválido\");\r\n      return res.status(400).json({ error: \"Arquivo inválido.\" });\r\n    }\r\n\r\n    const stream = fs.createReadStream(file.filepath);\r\n\r\n    const result = await new Promise<UploadApiResponse>((resolve, reject) => {\r\n      const upload = cloudinary.uploader.upload_stream(\r\n        { folder: \"usuarios\" },\r\n        (error, result) => {\r\n          if (error || !result) {\r\n            console.log(\"Erro no upload:\", error);\r\n            return reject(error || new Error(\"Erro no upload\"));\r\n          }\r\n          resolve(result);\r\n        }\r\n      );\r\n      stream.pipe(upload);\r\n    });\r\n\r\n    console.log(\"Upload concluído:\", result);\r\n    return res.status(200).json({ success: true, data: result });\r\n  } catch (error) {\r\n    console.error(\"Erro no upload:\", error);\r\n    return res.status(500).json({ error: \"Falha no upload\", detail: error instanceof Error ? error.message : error });\r\n  }\r\n}"],"names":[],"mappings":";;;;AACA;AACA;AAAA;AACA;;;;AAGO,MAAM,SAAS;IACpB,KAAK;QACH,YAAY;IACd;AACF;AAEA,SAAS,UAAU,GAAmB;IACpC,OAAO,IAAI,QAAgE,CAAC,SAAS;QACnF,MAAM,OAAO,IAAI,4JAAA,CAAA,UAAU,CAAC,YAAY;QACxC,KAAK,KAAK,CAAC,KAAK,CAAC,KAAK,QAAQ;YAC5B,IAAI,KAAK,OAAO;iBACX,QAAQ;gBAAE;gBAAQ;YAAM;QAC/B;IACF;AACF;AAEe,eAAe,KAAK,GAAmB,EAAE,GAAoB;IAC1E,QAAQ,GAAG,CAAC;IACZ,IAAI,IAAI,MAAM,KAAK,QAAQ,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;QAAE,OAAO;IAAqB;IAErF,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,UAAU;QAClC,QAAQ,GAAG,CAAC,uBAAuB;QAEnC,MAAM,YAAY,MAAM,IAAI,IAAI,OAAO,MAAM,CAAC,MAAM,CAAC,EAAE;QACvD,IAAI,CAAC,WAAW;YACd,QAAQ,GAAG,CAAC;YACZ,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO;YAA0B;QACjE;QAEA,MAAM,YAAY,MAAM,OAAO,CAAC,aAAa,YAAY;YAAC;SAAU;QACpE,MAAM,OAAO,SAAS,CAAC,EAAE;QACzB,IAAI,CAAC,QAAQ,CAAC,KAAK,QAAQ,EAAE;YAC3B,QAAQ,GAAG,CAAC;YACZ,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO;YAAoB;QAC3D;QAEA,MAAM,SAAS,6FAAA,CAAA,UAAE,CAAC,gBAAgB,CAAC,KAAK,QAAQ;QAEhD,MAAM,SAAS,MAAM,IAAI,QAA2B,CAAC,SAAS;YAC5D,MAAM,SAAS,0HAAA,CAAA,UAAU,CAAC,QAAQ,CAAC,aAAa,CAC9C;gBAAE,QAAQ;YAAW,GACrB,CAAC,OAAO;gBACN,IAAI,SAAS,CAAC,QAAQ;oBACpB,QAAQ,GAAG,CAAC,mBAAmB;oBAC/B,OAAO,OAAO,SAAS,IAAI,MAAM;gBACnC;gBACA,QAAQ;YACV;YAEF,OAAO,IAAI,CAAC;QACd;QAEA,QAAQ,GAAG,CAAC,qBAAqB;QACjC,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,SAAS;YAAM,MAAM;QAAO;IAC5D,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,mBAAmB;QACjC,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;YAAmB,QAAQ,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QAAM;IACjH;AACF","debugId":null}}]
}